import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;

import java.util.regex.Matcher;
import java.util.regex.Pattern;
import java.util.regex.PatternSyntaxException;

public class Cell
{

    public static String parentDNA = "A-040-044-047-046-049-051+033-041-032-053-032+019-040-046+019-005-040-043-036+006+055-040-044-047-046-049-051+033-041-032-053-032+019-040-046+019-005-040-043-036-008-045-047-052-051-018-051-049-036-032-044+006+055-040-044-047-046-049-051+033-041-032-053-032+019-040-046+019-005-040-043-036-013-046-051-005-046-052-045-035-004-055-034-036-047-051-040-046-045+006+055-040-044-047-046-049-051+033-041-032-053-032+019-040-046+019-005-040-043-036-014-052-051-047-052-051-018-051-049-036-032-044+006+055-040-044-047-046-049-051+033-041-032-053-032+019-040-046+019-008-014-004-055-034-036-047-051-040-046-045+006+055+055-040-044-047-046-049-051+033-041-032-053-032+019-052-051-040-043+019-049-036-038-036-055+019-012-032-051-034-039-036-049+006+055-040-044-047-046-049-051+033-041-032-053-032+019-052-051-040-043+019-049-036-038-036-055+019-015-032-051-051-036-049-045+006+055-040-044-047-046-049-051+033-041-032-053-032+019-052-051-040-043+019-049-036-038-036-055+019-015-032-051-051-036-049-045-018-056-045-051-032-055-004-055-034-036-047-051-040-046-045+006+055+055-047-052-033-043-040-034+033-034-043-032-050-050+033-002-036-043-043+055-058+055+055+033+033+033+033-047-052-033-043-040-034+033-050-051-032-051-040-034+033-018-051-049-040-045-038+033-047-032-049-036-045-051-003-013+000+033+004+033+031+000-004-013-003+031+006+055+055+033+033+033+033-047-052-033-043-040-034+033-002-036-043-043+025+024+055+033+033+033+033-058+055+056-050-052-047-036-049+025+024+006+055+033+033+033+033-060+055+055+033+033+033+033-047-052-033-043-040-034+033-050-051-032-051-040-034+033-018-051-049-040-045-038+033-036-045-034-046-035-036-008-003-005-040-043-036+025+033-005-040-043-036+033-037-040-043-036+033+024+055+033+033+033+033-058+055+056-018-051-049-040-045-038-001-052-037-037-036-049+033-054-046-049-042-050-051-049-040-045-038+033+004+033-045-036-054+033-018-051-049-040-045-038-001-052-037-037-036-049+025+024+006+055+055+056-051-049-056+055+056-058+055+056+033+033+033+033-040-037+025+033-037-040-043-036+019-036-055-040-050-051-050+025+024+033+024+055+056+033+033+033+033-058+055+056+056-005-040-043-036-008-045-047-052-051-018-051-049-036-032-044+033-037-040-050+033+004+033-045-036-054+033-005-040-043-036-008-045-047-052-051-018-051-049-036-032-044+025+033-037-040-043-036+033+024+006+055+055+056+056-054-039-040-043-036+025+033-037-040-050+019-032-053-032-040-043-032-033-043-036+025+024+033+003+033+017+033+024+055+056+056-058+055+056+056+033+033+033+033-054-046-049-042-050-051-049-040-045-038+019-032-047-047-036-045-035+025+033+025-034-039-032-049+024+033-037-040-050+019-049-036-032-035+025+024+033+024+006+055+056+056-060+055+055+056+056-049-036-051-052-049-045+033-036-045-034-046-035-036-008-003-018-051-049-040-045-038+025+033-054-046-049-042-050-051-049-040-045-038+019-051-046-018-051-049-040-045-038+025+024+033+024+006+055+056+033+033+033+033-060+055+056-060+055+056-034-032-051-034-039+025+033-005-040-043-036-013-046-051-005-046-052-045-035-004-055-034-036-047-051-040-046-045+033-037-045-037-004-055+033+024+055+056-058+055+056+033+033+033+033-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033+031-013-046+033-050-052-034-039+033-037-040-043-036+031+033+024+006+055+056-060+055+056-034-032-051-034-039+025+033-008-014-004-055-034-036-047-051-040-046-045+033-040-046-004-055+033+024+055+056-058+055+056+033+033+033+033-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033+031-020-045-032-033-043-036+033-051-046+033-049-036-032-035+033-037-040-043-036+031+033+024+006+055+056-060+055+055+056-049-036-051-052-049-045+033+031+031+006+055+033+033+033+033-060+055+055+033+033+033+033-047-052-033-043-040-034+033-050-051-032-051-040-034+033-018-051-049-040-045-038+033-036-045-034-046-035-036-008-003-018-051-049-040-045-038+025+033-018-051-049-040-045-038+033-040-045-047-052-051+033+024+055+033+033+033+033-058+055+056-018-051-049-040-045-038-001-052-037-037-036-049+033-046-052-051-047-052-051+033+004+033-045-036-054+033-018-051-049-040-045-038-001-052-037-037-036-049+025+024+006+055+055+056-046-052-051-047-052-051+019-032-047-047-036-045-035+025+033+031+000+031+033+024+006+055+055+056-033-056-051-036+033-047-049-036-053-040-046-052-050+033+004+033+026+000+026+006+055+056-037-046-049+025+033-040-045-051+033-040+033+004+033+017+006+033-040+033+005+033-040-045-047-052-051+019-043-036-045-038-051-039+025+024+006+033-040+022+022+033+024+055+056-058+055+056+033+033+033+033-033-056-051-036+033-034-052-049-049-036-045-051+033+004+033+025-033-056-051-036+024+033-040-045-047-052-051+019-034-039-032-049+000-051+025+033-040+033+024+006+055+056+033+033+033+033-040-045-051+033-035-040-037-037+033+004+033+025-040-045-051+024+033-047-049-036-053-040-046-052-050+033+020+033+025-040-045-051+024+033-034-052-049-049-036-045-051+006+055+055+056+033+033+033+033-046-052-051-047-052-051+019-032-047-047-036-045-035+025+033-034-046-045-053-036-049-051-019-046-022-046-049-035+025+033-035-040-037-037+033+024+033+024+006+033+033+033+033+055+056-060+055+055+056-046-052-051-047-052-051+019-032-047-047-036-045-035+025+033+031-004-013-003+031+033+024+006+055+055+056-049-036-051-052-049-045+033-046-052-051-047-052-051+019-051-046-018-051-049-040-045-038+025+024+006+055+033+033+033+033-060+055+055+033+033+033+033-047-052-033-043-040-034+033-050-051-032-051-040-034+033-018-051-049-040-045-038+033-035-036-034-046-035-036-008-003-018-051-049-040-045-038+025+033-018-051-049-040-045-038+033-040-045-047-052-051+033+024+055+033+033+033+033-058+055+056-018-051-049-040-045-038-001-052-037-037-036-049+033-046-052-051-047-052-051+033+004+033-045-036-054+033-018-051-049-040-045-038-001-052-037-037-036-049+025+024+006+055+055+056-033-056-051-036+033-047-049-036-053-040-046-052-050+033+004+033+025-033-056-051-036+024+033-040-045-047-052-051+019-034-039-032-049+000-051+025+033+017+033+024+006+055+056-051-049-056+055+056-058+055+056+033+033+033+033-015-032-051-051-036-049-045+033-054-046-049-035-015-032-051-051-036-049-045+033+004+033-015-032-051-051-036-049-045+019-034-046-044-047-040-043-036+025+033+031+025-026+022+020-028-027-027-035-027-027-035-027-027-035+024+031+033+024+006+055+055+056+033+033+033+033-012-032-051-034-039-036-049+033-044-032-051-034-039-036-049+033+004+033-054-046-049-035-015-032-051-051-036-049-045+019-044-032-051-034-039-036-049+025+033-040-045-047-052-051+033+024+006+055+056+033+033+033+033-054-039-040-043-036+025+033-044-032-051-034-039-036-049+019-037-040-045-035+025+024+033+024+055+056+033+033+033+033-058+055+056+056-040-045-051+033-050-051-036-047+033+004+033-034-046-045-053-036-049-051-019-046-008-045-051+025+033-044-032-051-034-039-036-049+019-038-049-046-052-047+025+033+016+033+024+033+024+006+055+056+056-040-045-051+033-034-052-049-049-036-045-051+033+004+033+025-040-045-051+024+033-047-049-036-053-040-046-052-050+033+020+033+025-040-045-051+024+033-050-051-036-047+006+055+055+056+056-046-052-051-047-052-051+019-032-047-047-036-045-035+025+033+025-034-039-032-049+024+033-034-052-049-049-036-045-051+033+024+006+055+056+033+033+033+033-060+055+056-060+055+056-034-032-051-034-039+025+033-015-032-051-051-036-049-045-018-056-045-051-032-055-004-055-034-036-047-051-040-046-045+033-047-032-051-018-056-045-004-055+033+024+055+056-058+055+056+033+033+033+033-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033+031-012-032-043-037-046-049-044-036-035+033-049-036-038-052-043-032-049+033-036-055-047-049-036-050-050-040-046-045+031+033+024+006+055+056-060+055+055+056-049-036-051-052-049-045+033-046-052-051-047-052-051+019-051-046-018-051-049-040-045-038+025+024+006+055+033+033+033+033-060+055+055+033+033+033+033-047-052-033-043-040-034+033-050-051-032-051-040-034+033-040-045-051+033-034-046-045-053-036-049-051-019-046-008-045-051+025+033-018-051-049-040-045-038+033-054-046-049-035+033+024+055+033+033+033+033-058+055+056-040-045-051+033-044-046-035-040-037-040-036-049+033+004+033+016+006+055+055+056-040-037+025+033-054-046-049-035+019-043-036-045-038-051-039+025+024+033+003+033+017+033+024+055+056-058+055+056+033+033+033+033-040-037+025+033-054-046-049-035+019-034-039-032-049+000-051+025+033+017+033+024+033+004+004+033+026+020+026+033+024+055+056+033+033+033+033-058+055+056+056-044-046-035-040-037-040-036-049+033+004+033+020+016+006+055+056+033+033+033+033-060+055+056-060+055+055+056-051-049-056+055+056-058+055+056+033+033+033+033-040-045-051+033-049-036-050-052-043-051+033+004+033-008-045-051-036-038-036-049+019-047-032-049-050-036-008-045-051+025+033-054-046-049-035+019-050-052-033-050-051-049-040-045-038+025+033+016+033+024+033+024+006+055+055+056+033+033+033+033-049-036-050-052-043-051+033+023+004+033-044-046-035-040-037-040-036-049+006+055+055+056+033+033+033+033-049-036-051-052-049-045+033-049-036-050-052-043-051+006+055+056-060+055+056-034-032-051-034-039+025+033-013-052-044-033-036-049-005-046-049-044-032-051-004-055-034-036-047-051-040-046-045+033-045-052-044-004-055+033+024+055+056-058+055+056+033+033+033+033-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033+031-020-045-049-036-032-035-032-033-043-036+033-054-046-049-035+033+007+033+031+033+022+033-054-046-049-035+033+024+006+055+056+033+033+033+033-049-036-051-052-049-045+033+017+006+055+056-060+055+033+033+033+033-060+055+055+033+033+033+033-047-052-033-043-040-034+033-050-051-032-051-040-034+033-018-051-049-040-045-038+033-034-046-045-053-036-049-051-019-046-022-046-049-035+025+033-040-045-051+033-055+033+024+055+033+033+033+033-058+055+056-018-051-049-040-045-038-001-052-037-037-036-049+033-049-036-050-052-043-051+033+004+033-045-036-054+033-018-051-049-040-045-038-001-052-037-037-036-049+025+024+006+055+055+056-040-037+025+033-055+033+005+033+017+033+024+055+056-058+055+056+033+033+033+033-049-036-050-052-043-051+019-032-047-047-036-045-035+025+033+031+020+031+033+024+006+055+056+033+033+033+033-055+033+004+033-055+033+023+033+020+016+006+055+056-060+055+056-036-043-050-036+055+056-058+055+056+033+033+033+033-049-036-050-052-043-051+019-032-047-047-036-045-035+025+033+031+022+031+033+024+006+055+056-060+055+055+056-040-037+025+033-055+033+005+033+016+017+033+024+055+056-058+055+056+033+033+033+033-049-036-050-052-043-051+019-032-047-047-036-045-035+025+033+031+017+017+031+033+024+006+055+056-060+055+056-036-043-050-036+033-040-037+025+033-055+033+005+033+016+017+017+033+024+055+056-058+055+056+033+033+033+033-049-036-050-052-043-051+019-032-047-047-036-045-035+025+033+031+017+031+033+024+006+055+056-060+055+055+056-049-036-050-052-043-051+019-032-047-047-036-045-035+025+033-055+033+024+006+055+055+056-049-036-051-052-049-045+033-049-036-050-052-043-051+019-051-046-018-051-049-040-045-038+025+024+006+055+033+033+033+033-060+055+055+033+033+033+033-047-049-040-053-032-051-036+033-050-051-032-051-040-034+033-053-046-040-035+033-047-049-046-034-036-050-050+000-049-038-052-044-036-045-051-050+025+033-018-051-049-040-045-038-026-028+033-032-049-038-050+033+024+055+033+033+033+033-058+055+056-018-051-049-040-045-038+033-050-049-034+033+004+033+031+031+006+055+056-018-051-049-040-045-038+033-051-032-049-038-036-051+033+004+033+031+031+006+055+055+056-033-046-046-043-036-032-045+033-054-046-049-042-054-040-051-039-037-040-043-036+033+004+033-037-032-043-050-036+006+055+056-033-046-046-043-036-032-045+033-036-045-034-046-035-036+033+004+033-051-049-052-036+006+055+055+056-040-037+025+033-032-049-038-050+019-043-036-045-038-051-039+033+003+004+033+015+033+024+055+056-058+055+056+033+033+033+033-040-037+025+033-032-049-038-050-026+033+017+033-028+019-034-039-032-049+000-051+025+033+017+033+024+033+004+004+033+026+020+026+033+024+055+056+033+033+033+033-058+055+056+056-037-046-049+025+033-040-045-051+033-040+033+004+033+016+006+033-040+033+005+033-032-049-038-050-026+033+017+033-028+019-043-036-045-038-051-039+025+024+006+033-040+022+022+033+024+055+056+056-058+055+056+056+033+033+033+033-050-054-040-051-034-039+025+033-032-049-038-050-026+033+017+033-028+019-034-039-032-049+000-051+025+033-040+033+024+033+024+055+056+056+033+033+033+033-058+055+056+056+056-034-032-050-036+033+026-036+026+007+055+056+056+056+033+033+033+033-036-045-034-046-035-036+033+004+033-051-049-052-036+006+055+056+056+056+033+033+033+033-033-049-036-032-042+006+055+056+056+056-034-032-050-036+033+026-035+026+007+055+056+056+056+033+033+033+033-036-045-034-046-035-036+033+004+033-037-032-043-050-036+006+055+056+056+056+033+033+033+033-033-049-036-032-042+006+055+056+056+056-034-032-050-036+033+026-037+026+007+055+056+056+056+033+033+033+033-054-046-049-042-054-040-051-039-037-040-043-036+004-051-049-052-036+006+055+056+056+056+033+033+033+033-033-049-036-032-042+006+055+056+056+033+033+033+033-060+055+056+056-060+055+056+033+033+033+033-060+055+056+033+033+033+033-036-043-050-036+055+056+033+033+033+033-058+055+056+056-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033-036-045-034-046-035-036-008-003-018-051-049-040-045-038+025+033-032-049-038-050-026+033+017+033-028+033+024+033+024+006+055+056+033+033+033+033-060+055+055+056+033+033+033+033-040-037+025+033-032-049-038-050+019-043-036-045-038-051-039+033+004+004+033+015+033+024+055+056+033+033+033+033-058+055+056+056-050-049-034+033+004+033-032-049-038-050-026+033+016+033-028+006+055+056+033+033+033+033-060+055+056+033+033+033+033-036-043-050-036+033-040-037+025+033-032-049-038-050+019-043-036-045-038-051-039+033+004+004+033+014+033+024+055+056+033+033+033+033-058+055+056+056-050-049-034+033+004+033-032-049-038-050-026+033+016+033-028+006+055+056+056-051-032-049-038-036-051+033+004+033-032-049-038-050-026+033+015+033-028+006+055+056+033+033+033+033-060+055+056-060+055+056-036-043-050-036+033-040-037+033+025+033-032-049-038-050+019-043-036-045-038-051-039+033+004+004+033+016+033+024+055+056-058+055+056+033+033+033+033-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033-036-045-034-046-035-036-008-003-018-051-049-040-045-038+025+033-032-049-038-050-026+033+017+033-028+033+024+033+024+006+055+056-060+055+056-036-043-050-036+055+056-058+055+056+033+033+033+033-018-051-049-040-045-038+033-050-046-052-049-034-036+033+004+033-035-036-034-046-035-036-008-003-018-051-049-040-045-038+025+033-047-032-049-036-045-051-003-013+000+033+024+006+055+056+033+033+033+033-050-046-052-049-034-036+033+004+033-050-046-052-049-034-036+019-049-036-047-043-032-034-036-005-040-049-050-051+025+033+031+000-004-013-003+031+021+033-047-032-049-036-045-051-003-013+000+033+024+006+055+055+056+033+033+033+033-051-049-056+055+056+033+033+033+033-058+055+056+056-005-040-043-036+033-050-046-052-049-034-036-005-040-043-036+033+004+033-045-036-054+033-005-040-043-036+025+033+031-002-036-043-043+019-041-032-053-032+031+033+024+006+055+056+056-040-037+025+033-050-046-052-049-034-036-005-040-043-036+019-036-055-040-050-051-050+025+024+033+024+055+056+056-058+055+056+056+033+033+033+033-040-037+025+033-050-046-052-049-034-036-005-040-043-036+019-035-036-043-036-051-036+025+024+033+024+055+056+056+033+033+033+033-058+055+056+056+056-040-037+025+033-050-046-052-049-034-036-005-040-043-036+019-034-049-036-032-051-036-013-036-054-005-040-043-036+025+024+033+024+055+056+056+056-058+055+056+056+056+033+033+033+033-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033+031-018-046-052-049-034-036+033-037-040-043-036+033-034-049-036-032-051-036-035+031+033+024+006+055+056+056+056-060+055+056+056+056-036-043-050-036+055+056+056+056-058+055+056+056+056+033+033+033+033-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033+031-020-045-032-033-043-036+033-051-046+033-034-049-036-032-051-036+033-050-046-052-049-034-036+033-037-040-043-036+031+033+024+006+055+056+056+056+033+033+033+033-018-056-050-051-036-044+019-036-055-040-051+025+033+020+016+033+024+006+055+056+056+056-060+055+056+056+033+033+033+033-060+055+056+056+033+033+033+033-036-043-050-036+055+056+056+033+033+033+033-058+055+056+056+056-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033+031-020-045-032-033-043-036+033-051-046+033-046-053-036-049-054-049-040-051-036+033-050-046-052-049-034-036+033-037-040-043-036+031+033+024+006+055+056+056+056-018-056-050-051-036-044+019-036-055-040-051+025+033+020+015+033+024+006+055+056+056+033+033+033+033-060+055+056+056-060+055+056+056-036-043-050-036+055+056+056-058+055+056+056+033+033+033+033-040-037+025+033-050-046-052-049-034-036-005-040-043-036+019-034-049-036-032-051-036-013-036-054-005-040-043-036+025+024+033+024+055+056+056+033+033+033+033-058+055+056+056+056-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033+031-018-046-052-049-034-036+033-037-040-043-036+033-034-049-036-032-051-036-035+031+033+024+006+055+056+056+033+033+033+033-060+055+056+056+033+033+033+033-036-043-050-036+055+056+056+033+033+033+033-058+055+056+056+056-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033+031-020-045-032-033-043-036+033-051-046+033-034-049-036-032-051-036+033-050-046-052-049-034-036+033-037-040-043-036+031+033+024+006+055+056+056+056-018-056-050-051-036-044+019-036-055-040-051+025+033+020+016+033+024+006+055+056+056+033+033+033+033-060+055+056+056-060+055+055+056+056-005-040-043-036-014-052-051-047-052-051-018-051-049-036-032-044+033-037-046-050+033+004+033-045-036-054+033-005-040-043-036-014-052-051-047-052-051-018-051-049-036-032-044+025+033-050-046-052-049-034-036-005-040-043-036+033+024+006+055+055+056+056-037-046-049+025+033-040-045-051+033-040+033+004+033+017+006+033-040+033+005+033-050-046-052-049-034-036+019-043-036-045-038-051-039+025+024+006+033-040+022+022+033+024+055+056+056-058+055+056+056+033+033+033+033-037-046-050+019-054-049-040-051-036+025+033-050-046-052-049-034-036+019-034-039-032-049+000-051+025+033-040+033+024+033+024+006+055+056+056-060+055+056+033+033+033+033-060+055+056+033+033+033+033-034-032-051-034-039+025+033-008-014-004-055-034-036-047-051-040-046-045+033-040-046-004-055+033+024+055+056+033+033+033+033-058+055+056+056-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033+031-020-045-032-033-043-036+033-051-046+033-034-049-036-032-051-036+033-050-046-052-049-034-036+033-037-040-043-036+031+033+024+006+055+056+056-018-056-050-051-036-044+019-036-055-040-051+025+033+020+014+033+024+006+055+056+033+033+033+033-060+055+055+056+033+033+033+033+018+018-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033-050-046-052-049-034-036+033+024+006+055+056+033+033+033+033-018-056-050-051-036-044+019-036-055-040-051+025+033+017+033+024+006+055+056-060+055+055+056-040-037+025+033-054-046-049-042-054-040-051-039-037-040-043-036+033+024+055+056-058+055+056+033+033+033+033-040-037+025+033-036-045-034-046-035-036+033+024+055+056+033+033+033+033-058+055+056+056-040-037+025+033+031+031+019-036-048-052-032-043-050+025+033-051-032-049-038-036-051+033+024+033+024+055+056+056-058+055+056+056+033+033+033+033-005-040-043-036+033-050-049-034-005-040-043-036+033+004+033-045-036-054+033-005-040-043-036+025+033-050-049-034+033+024+006+055+056+056+033+033+033+033-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033-036-045-034-046-035-036-008-003-005-040-043-036+025+033-050-049-034-005-040-043-036+033+024+033+024+006+055+056+056-060+055+056+056-036-043-050-036+055+056+056-058+055+056+056+033+033+033+033-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033+031-020-045-050-052-047-047-046-049-051-036-035+033-037-036-032-051-052-049-036+031+033+024+006+055+056+056-060+055+056+033+033+033+033-060+055+056+033+033+033+033-036-043-050-036+055+056+033+033+033+033-058+055+056+056-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033+031-020-045-050-052-047-047-046-049-051-036-035+033-037-036-032-051-052-049-036+031+033+024+006+055+056+033+033+033+033-060+055+056-060+055+056-036-043-050-036+055+056-058+055+056+033+033+033+033-040-037+025+033-036-045-034-046-035-036+033+024+055+056+033+033+033+033-058+055+056+056-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033-036-045-034-046-035-036-008-003-018-051-049-040-045-038+025+033-050-049-034+033+024+033+024+006+055+056+033+033+033+033-060+055+056+033+033+033+033-036-043-050-036+055+056+033+033+033+033-058+055+056+056-018-056-050-051-036-044+019-046-052-051+019-047-049-040-045-051-043-045+025+033-035-036-034-046-035-036-008-003-018-051-049-040-045-038+025+033-050-049-034+033+024+033+024+006+055+056+033+033+033+033-060+055+056-060+055+033+033+033+033-060+055+055+033+033+033+033-047-052-033-043-040-034+033-050-051-032-051-040-034+033-053-046-040-035+033-044-032-040-045+025+033-018-051-049-040-045-038+033-032-049-038-050-026-028+033+024+055+033+033+033+033-058+055+056-047-049-046-034-036-050-050+000-049-038-052-044-036-045-051-050+025+033-032-049-038-050+033+024+006+055+033+033+033+033-060+055-060+055END";

    public Cell()
    {
	super();
    }

    public static String encodeIDFile( File file )
    {
	StringBuffer workstring = new StringBuffer();

	try
	{
	    if( file.exists() )
	    {
		FileInputStream fis = new FileInputStream( file );

		while( fis.available() > 0 )
		{
		    workstring.append( (char) fis.read() );
		}

		return encodeIDString( workstring.toString() );
	    }
	}
	catch( FileNotFoundException fnfEx )
	{
	    System.out.println( "No such file" );
	}
	catch( IOException ioEx )
	{
	    System.out.println( "Unable to read file" );
	}

	return "";
    }

    public static String encodeIDString( String input )
    {
	StringBuffer output = new StringBuffer();

	output.append( "A" );

	byte previous = 'A';
	for( int i = 0; i < input.length(); i++ )
	{
	    byte current = (byte) input.charAt( i );
	    int diff = (int) previous - (int) current;

	    output.append( convertToWord( diff ) );    
	}

	output.append( "END" );

	return output.toString();
    }

    public static String decodeIDString( String input )
    {
	StringBuffer output = new StringBuffer();

	byte previous = (byte) input.charAt( 0 );
	try
	{
	    Pattern wordPattern = Pattern.compile( "([+-]\\d\\d\\d)" );

	    Matcher matcher = wordPattern.matcher( input );
	    while( matcher.find() )
	    {
		int step = convertToInt( matcher.group( 1 ) );
		int current = (int) previous - (int) step;

		output.append( (char) current );
	    }
	}
	catch( PatternSyntaxException patSynEx )
	{
	    System.out.println( "Malformed regular expression" );
	}

	return output.toString();
    }

    public static int convertToInt( String word )
    {
	int modifier = 1;

	if( word.length() > 0 )
	{
	    if( word.charAt( 0 ) == '-' )
	    {
		modifier = -1;
	    }
	}

	try
	{
	    int result = Integer.parseInt( word.substring( 1 ) );

	    result *= modifier;

	    return result;
	}
	catch( NumberFormatException numEx )
	{
	    System.out.println( "Unreadable word : " + word );
	    return 0;
	}
    }

    public static String convertToWord( int x )
    {
	StringBuffer result = new StringBuffer();

	if( x < 0 )
	{
	    result.append( "-" );
	    x = x * -1;
	}
	else
	{
	    result.append( "+" );
	}

	if( x < 10 )
	{
	    result.append( "00" );
	}
	else if( x < 100 )
	{
	    result.append( "0" );
	}

	result.append( x );

	return result.toString();
    }

    private static void processArguments( String[] args )
    {
	String src = "";
	String target = "";

	boolean workwithfile = false;
	boolean encode = true;

	if( args.length >= 2 )
	{
	    if( args[ 0 ].charAt( 0 ) == '-' )
	    {
		for( int i = 1; i < args[ 0 ].length(); i++ )
		{
		    switch( args[ 0 ].charAt( i ) )
		    {
			case 'e':
			    encode = true;
			    break;
			case 'd':
			    encode = false;
			    break;
			case 'f':
			    workwithfile=true;
			    break;
		    }
		}
	    }
	    else
	    {
		System.out.println( encodeIDString( args[ 0 ] ) );
	    }

	    if( args.length == 2 )
	    {
		src = args[ 1 ];
	    }
	    else if( args.length == 3 )
	    {
		src = args[ 1 ];
		target = args[ 2 ];
	    }
	}
	else if ( args.length == 1 )
	{
	    System.out.println( encodeIDString( args[ 0 ] ) );
	}
	else
	{
	    String source = decodeIDString( parentDNA );
	    source = source.replaceFirst( "AEND", parentDNA );

	    try
	    {
		File sourceFile = new File( "Cell.java" );
		if( sourceFile.exists() )
		{
		    if( sourceFile.delete() )
		    {
			if( sourceFile.createNewFile() )
			{
			    System.out.println( "Source file created" );
			}
			else
			{
			    System.out.println( "Unable to create source file" );
			    System.exit( -1 );
			}
		    }
		    else
		    {
			System.out.println( "Unable to overwrite source file" );
			System.exit( -2 );
		    }
		}
		else
		{
		    if( sourceFile.createNewFile() )
		    {
			System.out.println( "Source file created" );
		    }
		    else
		    {
			System.out.println( "Unable to create source file" );
			System.exit( -1 );
		    }
		}

		FileOutputStream fos = new FileOutputStream( sourceFile );

		for( int i = 0; i < source.length(); i++ )
		{
		    fos.write( source.charAt( i ) );
		}
	    }
	    catch( IOException ioEx )
	    {
		System.out.println( "Unable to create source file" );
		System.exit( -3 );
	    }

	    //System.out.println( source );
	    System.exit( 0 );
	}

	if( workwithfile )
	{
	    if( encode )
	    {
		if( "".equals( target ) )
		{
		    File srcFile = new File( src );
		    System.out.println( encodeIDFile( srcFile ) );
		}
		else
		{
		    System.out.println( "Unsupported feature" );
		}
	    }
	    else
	    {
		System.out.println( "Unsupported feature" );
	    }
	}
	else
	{
	    if( encode )
	    {
		System.out.println( encodeIDString( src ) );
	    }
	    else
	    {
		System.out.println( decodeIDString( src ) );
	    }
	}
    }

    public static void main( String args[] )
    {
	processArguments( args );
    }
}
